<!DOCTYPE html>
<html lang="en">
<head>
    <title>ALTITUDE</title>

    ${include("includes/header_common.ssp")}

    <style>
        #importOptions {
            display: grid;
            height:  100%;
            grid-template-columns: 1fr auto 1fr;
            place-items: center;
        }

        #browseForFiles {
            grid-column: 2;
            width: 100%;
            display: grid;
            padding: 20px;
            border: 1px solid #ccc;
            border-radius: 5px;
            place-items: center;
            background-color: var(--form-background-color);
        }
    </style>
</head>

#import(software.altitude.core.RequestContext)

<body>

<div>
    ${include("includes/nav.ssp")}
</div>

<main>
    <script lang="js" type="module">
        htmx.on('htmx:wsOpen', function(evt) {
            console.log('Connection is OPEN');
        });
        htmx.on('htmx:wsClose', function(evt) {
            console.log('Connection is CLOSED');
        });
        htmx.on('htmx:wsAfterMessage', function(evt) {
            console.log('wsAfterMessage');
            console.log(evt.detail.message);
        });
    </script>

    <div id="notifications"></div>
    <%@ val userId: String %>
    <div hx-ext="ws" hx-target=#notifications" ws-connect="/import/status?userId=<%= userId %>">
        <div id="status"></div>
    </div>

    <div id="importOptions">
        <div id="browseForFiles">
            ${include("htmx/upload_form.ssp")}
        </div>
    </div>
</main>

<footer>
    <%= RequestContext.account.value.getOrElse("None") %>
</footer>

<script lang="js">
    highlightNav("import");
</script>

</body>
</html>
